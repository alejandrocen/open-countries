name: open-countries CI

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Build docker
        run: docker build . -t open-countries:latest
      - name: Tests
        run: docker run -e MONGO_HOST=${{ secrets.MONGO_HOST }} open-countries:latest rake test
      - name: Linter
        run: docker run open-countries:latest rake rubocop
